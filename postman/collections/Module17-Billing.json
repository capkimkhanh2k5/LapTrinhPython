{
    "info": {
        "_postman_id": "module17-billing",
        "name": "Module 17: Subscriptions & Payments",
        "description": "API Billing & Payments - 28 endpoints",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{token}}",
                "type": "string"
            }
        ]
    },
    "item": [
        {
            "name": "17.1 Subscription Plans",
            "item": [
                {
                    "name": "List Subscription Plans",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/subscription-plans",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "subscription-plans"
                            ]
                        }
                    }
                },
                {
                    "name": "Get Plan Detail",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "var json = pm.response.json();",
                                    "if (json.id) pm.environment.set('plan_id', json.id);"
                                ]
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/subscription-plans/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "subscription-plans",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "1"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Create Plan (Admin)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"Enterprise Plan\",\n  \"slug\": \"enterprise\",\n  \"price\": 999,\n  \"duration_months\": 12,\n  \"max_jobs\": 100,\n  \"max_applications\": 5000,\n  \"features\": [\"AI Matching\", \"Priority Support\", \"Analytics\"],\n  \"is_active\": true\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/subscription-plans",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "subscription-plans"
                            ]
                        }
                    }
                },
                {
                    "name": "Update Plan",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"price\": 1199\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/subscription-plans/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "subscription-plans",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{plan_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Delete Plan",
                    "request": {
                        "method": "DELETE",
                        "url": {
                            "raw": "{{base_url}}/subscription-plans/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "subscription-plans",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{plan_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Compare Plans",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/subscription-plans/compare",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "subscription-plans",
                                "compare"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "17.2 Company Subscriptions",
            "item": [
                {
                    "name": "Get Current Subscription",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "var json = pm.response.json();",
                                    "if (json.id) pm.environment.set('subscription_id', json.id);"
                                ]
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/companies/:id/subscription",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "subscription"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Subscribe to Plan",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"plan_id\": {{plan_id}},\n  \"payment_method\": \"credit_card\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/companies/:id/subscribe",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "subscribe"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Upgrade Plan",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"new_plan_id\": 2\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/companies/:id/upgrade",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "upgrade"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Downgrade Plan",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"new_plan_id\": 1\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/companies/:id/downgrade",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "downgrade"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Cancel Subscription",
                    "request": {
                        "method": "POST",
                        "url": {
                            "raw": "{{base_url}}/companies/:id/cancel-subscription",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "cancel-subscription"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Renew Subscription",
                    "request": {
                        "method": "POST",
                        "url": {
                            "raw": "{{base_url}}/companies/:id/renew-subscription",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "renew-subscription"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Toggle Auto-Renew",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"auto_renew\": true\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/companies/:id/auto-renew",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "auto-renew"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Get Subscription History",
                    "request": {
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/companies/:id/subscription-history",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "subscription-history"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Get Subscription Usage",
                    "request": {
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/companies/:id/subscription-usage",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "subscription-usage"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Get Expiring Subscriptions",
                    "request": {
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/subscriptions/expiring-soon",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "subscriptions",
                                "expiring-soon"
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "17.3 Payment Methods",
            "item": [
                {
                    "name": "List Payment Methods",
                    "request": {
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/payment-methods",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "payment-methods"
                            ]
                        }
                    }
                },
                {
                    "name": "Add Payment Method (Admin)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"Bank Transfer\",\n  \"code\": \"bank_transfer\",\n  \"is_active\": true\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/payment-methods",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "payment-methods"
                            ]
                        }
                    }
                },
                {
                    "name": "Update Payment Method",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"name\": \"Bank Transfer Updated\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/payment-methods/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "payment-methods",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "1"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Toggle Payment Method",
                    "request": {
                        "method": "PATCH",
                        "url": {
                            "raw": "{{base_url}}/payment-methods/:id/toggle",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "payment-methods",
                                ":id",
                                "toggle"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "1"
                                }
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "17.4 Transactions",
            "item": [
                {
                    "name": "List Transactions",
                    "request": {
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/transactions?page=1",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "transactions"
                            ],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "1"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Get Transaction Detail",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "var json = pm.response.json();",
                                    "if (json.id) pm.environment.set('transaction_id', json.id);"
                                ]
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/transactions/:id",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "transactions",
                                ":id"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{transaction_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Create Transaction",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"company_id\": {{company_id}},\n  \"amount\": 999,\n  \"payment_method\": \"credit_card\",\n  \"description\": \"Subscription payment\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/transactions",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "transactions"
                            ]
                        }
                    }
                },
                {
                    "name": "Update Transaction Status",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"status\": \"completed\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/transactions/:id/status",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "transactions",
                                ":id",
                                "status"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{transaction_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Refund Transaction",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"reason\": \"Customer request\"\n}",
                            "options": {
                                "raw": {
                                    "language": "json"
                                }
                            }
                        },
                        "url": {
                            "raw": "{{base_url}}/transactions/:id/refund",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "transactions",
                                ":id",
                                "refund"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{transaction_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Export Transactions",
                    "request": {
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/transactions/export?format=csv",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "transactions",
                                "export"
                            ],
                            "query": [
                                {
                                    "key": "format",
                                    "value": "csv"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Get Company Transactions",
                    "request": {
                        "method": "GET",
                        "url": {
                            "raw": "{{base_url}}/companies/:id/transactions",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "companies",
                                ":id",
                                "transactions"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{company_id}}"
                                }
                            ]
                        }
                    }
                },
                {
                    "name": "Verify Transaction",
                    "request": {
                        "method": "POST",
                        "url": {
                            "raw": "{{base_url}}/transactions/:id/verify",
                            "host": [
                                "{{base_url}}"
                            ],
                            "path": [
                                "transactions",
                                ":id",
                                "verify"
                            ],
                            "variable": [
                                {
                                    "key": "id",
                                    "value": "{{transaction_id}}"
                                }
                            ]
                        }
                    }
                }
            ]
        }
    ]
}